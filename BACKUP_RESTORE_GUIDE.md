# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö MoodTrackerBot

## –°–ø–æ—Å–æ–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –Ω–∞ Render

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ SSH (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)

#### –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
```bash
python scripts/deploy_restore.py [backup_date]
```

–ü—Ä–∏–º–µ—Ä:
```bash
python scripts/deploy_restore.py 20250627_201421
```

#### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:
1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É Render —á–µ—Ä–µ–∑ SSH
2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –±—ç–∫–∞–ø–∞ `logs.csv` –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. –°–æ–∑–¥–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
4. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑—É –Ω–∞ SSD –¥–∏—Å–∫–µ
5. –û—á–∏—â–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É –±–æ—Ç–∞

#### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –±—ç–∫–∞–ø–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –±—ç–∫–∞–ø–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ–¥–Ω–∏–º –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤:

**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ SSH –≤—Ä—É—á–Ω—É—é**
```bash
scp backups/20250627_201421/logs.csv srv-cssvk3ogph6c7399j0gg@ssh.oregon.render.com:/MoodTrackerBot_data/backup_logs.csv
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ SFTP**
```bash
sftp srv-cssvk3ogph6c7399j0gg@ssh.oregon.render.com
put backups/20250627_201421/logs.csv /MoodTrackerBot_data/backup_logs.csv
exit
```

#### –®–∞–≥ 2: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É –±–æ—Ç—É:
```
/restore_backup
```

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ.

### –°–ø–æ—Å–æ–± 3: –†—É—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ SSH

#### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
```bash
ssh srv-cssvk3ogph6c7399j0gg@ssh.oregon.render.com
```

#### –®–∞–≥ 2: –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
```bash
cd /opt/render/project/src
```

#### –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –±—ç–∫–∞–ø–∞ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω)
```bash
# –°–æ–∑–¥–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
nano /MoodTrackerBot_data/backup_logs.csv
# –í—Å—Ç–∞–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ CSV —Ñ–∞–π–ª–∞
```

#### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
```bash
python scripts/restore_data.py
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ –±—ç–∫–∞–ø–∞

–§–∞–π–ª `logs.csv` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:
- `id` - ID –∑–∞–ø–∏—Å–∏
- `user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
- `event_type` - —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è (answer_emotional, answer_physical, activity, etc.)
- `timestamp` - –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO
- `details` - –¥–µ—Ç–∞–ª–∏ —Å–æ–±—ã—Ç–∏—è (–Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Ç.–¥.)

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –ß–µ—Ä–µ–∑ –±–æ—Ç–∞:
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/menu`
2. –í—ã–±–µ—Ä–∏—Ç–µ "üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª—é–±–æ–π —Ç–∏–ø –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

### –ß–µ—Ä–µ–∑ SSH:
```bash
ssh srv-cssvk3ogph6c7399j0gg@ssh.oregon.render.com
cd /opt/render/project/src
python -c "from database_safe import get_db_session, Log, User; 
with get_db_session() as s: 
    print(f'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {s.query(User).count()}'); 
    print(f'–ó–∞–ø–∏—Å–µ–π: {s.query(Log).count()}')"
```

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –ü—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ:
1. –°–æ–∑–¥–∞–π—Ç–µ –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º:
   ```bash
   python scripts/backup_data.py
   ```

2. –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:
   ```bash
   python scripts/deploy_restore.py
   ```

### –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è:
```bash
#!/bin/bash
echo "üì¶ –°–æ–∑–¥–∞–µ–º –±—ç–∫–∞–ø..."
python scripts/backup_data.py

echo "üöÄ –î–µ–ø–ª–æ–∏–º –Ω–∞ Render..."
git push origin main

echo "‚è≥ –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–ø–ª–æ—è (60 —Å–µ–∫—É–Ω–¥)..."
sleep 60

echo "üîÑ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ..."
python scripts/deploy_restore.py

echo "‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω!"
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "–§–∞–π–ª –±—ç–∫–∞–ø–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–º—è —Ñ–∞–π–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è SSH
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –∫–ª—é—á: `~/.ssh/id_rsa`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ Render
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –≤—Ä—É—á–Ω—É—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –∑–∞–ø–∏—Å–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `/MoodTrackerBot_data`

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –§–∞–π–ª—ã –±—ç–∫–∞–ø–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—Ç –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –£–¥–∞–ª—è–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ –±—ç–∫–∞–ø—ã –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ
- –†–µ–≥—É–ª—è—Ä–Ω–æ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ –±—ç–∫–∞–ø—ã 